"""
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
"""

import json
from psycopg2 import sql
from zigffi import _lib

# from aggregate import calculate_schedule_date
import time
import gc
import io
import boto3
import psycopg2

# COSTING_BUCKET_NAME = "stt-bucket"
#
# s3_target = boto3.resource(
#     "s3",
#     aws_access_key_id="minioadmin",
#     aws_secret_access_key="minioadmin",
#     endpoint_url="http://localhost:9000",
# )
#
# start_time = time.perf_counter()
#
#
# uma_key = "AGGREGATE/20240628T023814/unmatched_proforma_ma_list.json"
# rp_key = "AGGREGATE/20240628T023814/proforma_rp_list.json"
#
# # uma_list_str = s3.read_key(uma_key, bucket_name=PROCESS_BUCKET_NAME)
#
# rp_list_obj = s3_target.Object(COSTING_BUCKET_NAME, rp_key)
# rp_list_str = rp_list_obj.get()["Body"].read().decode("utf-8")
# rp_list = json.loads(rp_list_str)
#
# uma_list_obj = s3_target.Object(COSTING_BUCKET_NAME, uma_key)
# uma_list_str = uma_list_obj.get()["Body"].read().decode("utf-8")
# uma_list = json.loads(uma_list_str)
#
#
# rp_dict = {rp[0]: [rp[1], rp[2], rp[3], rp[4]] for rp in rp_list}
# from pprint import pprint
#
# pprint(rp_dict)
#
# end_time = time.perf_counter()
# elapsed_time = end_time - start_time
# print("Elapsed time reformat partner dict: ", elapsed_time)
#
# min_date = "2024-06-08 02:19:52"
# max_date = "2024-06-21 04:47:58"
#
# start_time = time.perf_counter()
#
# DSN_AIRFLOW = "postgres://son:son@127.0.0.1:6543/lion_airflow"
# with psycopg2.connect(DSN_AIRFLOW) as airflow_conn:
#     with airflow_conn.cursor() as cur:
#         uma_filter = ""
#         if len(uma_list) > 0:
#             uma_filter = sql.SQL(f"""
#             AND si.mother_account not in ({','.join([f"'{w}'" for w in uma_list])})
#             """).string
#
#         query = sql.SQL(f"""
#             SELECT
#             ss.stt_id,
#             ss.latest_stt_ts,
#             TO_CHAR(si.stt_date, 'YYYY-MM-DD HH24:MI:SS') as stt_date,
#             TO_CHAR(si.modified_at, 'YYYY-MM-DD HH24:MI:SS') as modified_at,
#             si.mother_account,
#             si.platform_type
#             FROM stt_selector ss
#             JOIN stt_ingest si ON si.stt_ts = ss.latest_stt_ts
#
#             WHERE si.stt_date >= '{min_date}' AND si.stt_date <= '{max_date}'
#             AND ss.stt_book_date >= '{min_date}' AND ss.stt_book_date <= '{max_date}'
#
#             AND si.proforma_invoice = 'Y'
#             AND COALESCE(si.do_flag, 'Y') != 'N'
#             AND ss.odoo_proforma_stt_detail_id IS NULL
#             AND (
#                 ss.proforma_stt_ts IS NULL
#                 OR
#                 ss.proforma_stt_ts != ss.latest_stt_ts
#             )
#             AND (
#                 ss.proforma_transaction_id IS NULL
#                 OR
#                 ss.proforma_stt_ts < si.stt_ts
#             )
#             {uma_filter};
#         """)
#         # print(cur.mogrify(query).decode())
#         #         raise
#         cur.execute(query)
#         results = cur.fetchall()
#         print(results)
# %%
# sample input

# rp_dict = {
#     "10": [32306, "daily", "ATP PACKING (OLSHOP)", None],
#     "1012": [73116, "daily", "1012", None],
#     "102": [56986, "monthly", "PT. INGENIO MEDIKA NUSANTARA", None],
#     "1038": [72969, "daily", "1038", None],
#     "1073": [31228, "daily", "ENDO INDONESIA, PT (B2C)", None],
#     "109": [72813, "daily", "109", None],
#     "1138": [72636, "daily", "1138", None],
#     "1140": [72756, "daily", "1140", None],
#     "1196": [31089, "daily", "WIN ACCES TELECOMMUNICATION, PT (B2B)", None],
#     "1205": [31079, "daily", "SERASI AUTORAYA, PT (B2B)", None],
#     "1217": [58738, "monthly", "PT. ANUGRAH ARGON MEDICA NON CCP", None],
#     "1220": [55387, "weekly", "PT. SEDAYA MITRA SEJAHTERA", None],
#     "1243": [72619, "daily", "1243", None],
#     "1249": [58012, "weekly", "PT. Kuark International", None],
#     "1269": [72995, "daily", "1269", None],
#     "1290": [57474, "monthly", "PT DIMENSI CITRA SEMESTA", None],
#     "1300": [72616, "daily", "1300", None],
#     "1308": [30971, "daily", "PUTRAGUNA JAYAMULIA, PT (B2C)", None],
#     "1315": [57609, "weekly", "PT. INDOTRUCK UTAMA", None],
#     "1320": [58484, "weekly", "CV. QUANTUM MEDIA SOLUSINDO", None],
#     "1323": [72911, "daily", "1323", None],
#     "1324": [30950, "daily", "TRAKTOR GEMILANG PERKASA, PT (B2C)", None],
#     "1325": [73022, "daily", "1325", None],
#     "1327": [72730, "daily", "1327", None],
#     "1338": [30935, "daily", "MARGA NUSANTARA JAYA, PT (B2B)", None],
#     "1366": [30904, "daily", "FEDEX EXPRESS INTERNATIONAL, PT (B2B)", None],
#     "1368": [72888, "daily", "1368", None],
#     "13796": [32449, "daily", "GRAHA LAYAR PRIMA, PT (B2B)", None],
#     "13807": [32438, "daily", "SFS GROUP (OLSHOP)", None],
#     "13811": [73148, "daily", "13811", None],
#     "13818": [32431, "daily", "BORNEO RAYA MANDIRI, PT (B2C)", None],
#     "13838": [32405, "daily", "BRILLIANT ECOMMERCE BERJAYA, PT (B2B)", None],
#     "13840": [32410, "daily", "INTAN CHEMICAL, PT (B2C)", None],
#     "13859": [72686, "daily", "13859", None],
#     "13873": [59971, "weekly", "PT. SKY ULTIMA SUKSES", None],
#     "13876": [72688, "daily", "13876", None],
#     "13899": [72711, "daily", "13899", None],
#     "13903": [32338, "daily", "ENSEVAL PUTERA MEGATRADING TBK, PT (B2B)", None],
#     "1402": [30860, "daily", "INTI CITRA AGUNG, PT", None],
#     "1409": [72802, "daily", "1409", None],
#     "1411": [72752, "daily", "1411", None],
#     "1414": [58367, "weekly", "PT CAKRA MEDIKA UTAMA", None],
#     "1417": [30843, "daily", "MURNI SOLUSINDO NUSANTARA, PT", None],
#     "1423": [56601, "monthly", "PT. Imedco Djaja", None],
#     "143": [32182, "daily", "ARGENTA TEKNIKA INTRAMAS, PT (B2C)", None],
#     "1440": [72884, "daily", "1440", None],
#     "1441": [56148, "monthly", "PT. TRANS OCEAN SERVICES INDONESIA", None],
#     "14501": [32458, "daily", "SURYA FAJAR INDONESIA, PT (B2B)", None],
#     "14525": [72642, "daily", "14525", None],
#     "1460": [59710, "monthly", "PT. HARMONI DINAMIKA INDONESIA", None],
#     "1466": [30790, "daily", "FLEMINGS INDONESIA, PT", None],
#     "14662": [73048, "daily", "14662", None],
#     "14686": [29679, "weekly", "PT. DUTAMULTI INTIOPTIC PRATAMA", None],
#     "14698": [72723, "daily", "14698", None],
#     "14843": [72912, "daily", "14843", None],
#     "14923": [29710, "weekly", "PT ENSEVAL PUTERA MEGATRADING", None],
#     "1494": [73043, "daily", "1494", None],
#     "14968": [72634, "daily", "14968", None],
#     "15006": [72627, "daily", "15006", None],
#     "1518": [30732, "daily", "GALOEH HUSADA FARMA, PT", None],
#     "1521": [73038, "daily", "1521", None],
#     "1525": [72925, "daily", "1525", None],
#     "15331": [72881, "daily", "15331", None],
#     "15333": [29771, "monthly", "GALERI HANIA SONGKET", None],
#     "15376": [73053, "daily", "15376", None],
#     "15469": [29819, "monthly", "PT. LEJEL SHOPPING COD", None],
#     "15506": [56137, "weekly", "PT.GUARDIA TEKNOLOGI INDONESIA", None],
#     "15570": [72980, "daily", "15570", None],
#     "15669": [72971, "daily", "15669", None],
#     "1570": [30680, "daily", "TUPPERWARE INDONESIA (B2C)", None],
#     "1572": [72644, "daily", "1572", None],
#     "15742": [56576, "weekly", "PT. TREN MODA GLOBAL", None],
#     "15775": [73021, "daily", "15775", None],
#     "1584": [72565, "daily", "1584", None],
#     "1585": [55502, "monthly", "PT NUSA PRIMA EKSPRESS (COD)", None],
#     "1591": [30657, "daily", "SETIA ANDALAN SUKSES, PT", None],
#     "1594": [30653, "daily", "WAWA GEMILANG INTERAKTIF, PT", None],
#     "15943": [72779, "daily", "15943", None],
#     "15971": [72559, "daily", "15971", None],
#     "15989": [72909, "daily", "15989", None],
#     "1606": [70810, "weekly", "AALTJE BAKERY (copy)", None],
#     "1612": [30635, "daily", "VIVI ZUBEDI CGK (OLSHOP)", None],
#     "16245": [73067, "daily", "16245", None],
#     "16247": [70422, "monthly", "DIGISKY NAGA UTAMA, CV", None],
#     "16254": [59328, "weekly", "ZHARA HONEY", None],
#     "16292": [62338, "Weekly", "RAM OLSHOP", None],
#     "16467": [72712, "daily", "16467", None],
#     "1656": [30600, "daily", "BANK CENTRAL ASIA TBK, PT (B2B)", None],
#     "16583": [72787, "daily", "16583", None],
#     "16587": [62409, "Monthly", "PT. CESCO LOGISTIK INDONESIA", None],
#     "16760": [62361, "Monthly", "CV. DUNIA SEHAT SENTOSA", None],
#     "16804": [62368, "Monthly", "CV. PERKASA PALMA NUSANTARA", None],
#     "1690": [57245, "monthly", "PT. DATINDO INFONET PRIMA", None],
#     "16937": [69810, "weekly", "BATIK GAYA (OLSHOP)", None],
#     "17202": [69807, "Monthly", "BIROTIKA SEMESTA, PT (B2B) (SUB)", None],
#     "17215": [69793, "monthly", "LOGISTERS ASIA PASIFIC, PT (B2B)", None],
#     "17222": [72774, "daily", "17222", None],
#     "17262": [72932, "daily", "17262", None],
#     "17281": [72783, "daily", "17281", None],
#     "17320": [69841, "Monthly", "CYBER SMART NETWORK ASIA, PT (B2B)", None],
#     "17354": [73166, "daily", "17354", None],
#     "1742": [31425, "daily", "PARAMA GLOBAL INSPIRA (PARAGON), PT (B2B)", None],
#     "17428": [72603, "daily", "17428", None],
#     "17563": [69953, "Monthly", "ALDEBARA BRANDED SHOES (OLSHOP)", None],
#     "1766": [72588, "daily", "1766", None],
#     "17747": [72675, "daily", "17747", None],
#     "1785": [72777, "daily", "1785", None],
#     "17858": [72626, "daily", "17858", None],
#     "1787": [73008, "daily", "1787", None],
#     "17916": [72577, "daily", "17916", None],
#     "1792": [59464, "monthly", "LARA THALIA ABADI PT (B2B)", None],
#     "17926": [72638, "daily", "17926", None],
#     "1797": [54695, "weekly", "PT. CAHAYA DESAIN INDONESIA", 497],
#     "18003": [70396, "Monthly", "VARASH SADDAN NUSANTARA, PT (B2C)", None],
#     "1801": [72963, "daily", "1801", None],
#     "1825": [54795, "monthly", "PT.SINAR EKA SELARAS", None],
#     "1832": [57680, "monthly", "PT. TELETAMA ARTHA MANDIRI", None],
#     "18322": [73049, "daily", "18322", None],
#     "1835": [30548, "daily", "NUSA ABADI SUKSES ARTHA, PT", None],
#     "1836": [58305, "monthly", "MITRA INTERNASIONAL INDONESIA PT (B2B)", None],
#     "1838": [72960, "daily", "1838", None],
#     "1839": [58519, "monthly", "PT. DATA CITRA MANDIRI", None],
#     "1849": [57151, "monthly", "YAYASAN PENGEMBANG ANAK", None],
#     "1864": [30458, "daily", "ULTRA JAYA MILK TBK, PT (B2B)", None],
#     "18731": [70557, "monthly", "OKTAGON MULTI SARANA, PT (B2C)", None],
#     "18781": [70564, "monthly", "MITRA MINERAL PERKASA, PT (B2B)", None],
#     "1879": [30444, "daily", "TOYOTA ASTRA MOTOR, PT", None],
#     "18840": [70570, "monthly", "GIORDANO INDONESIA, PT (B2B)", None],
#     "18850": [72975, "daily", "18850", None],
#     "1895": [30428, "daily", "CATUR SENTOSA BERHASIL, PT (B2B)", None],
#     "19108": [72950, "daily", "19108", None],
#     "1914": [73074, "daily", "1914", None],
#     "19183": [72970, "daily", "19183", None],
#     "19205": [72129, "daily", "19205", None],
#     "1929": [57615, "monthly", "MIRANDA MODA INDONESIA CV (B2B)", None],
#     "19346": [72130, "daily", "19346", None],
#     "19417": [72572, "daily", "19417", None],
#     "19453": [72953, "daily", "19453", None],
#     "19496": [72698, "daily", "19496", None],
#     "19715": [72580, "daily", "19715", None],
#     "1979": [70413, "monthly", "NUSANTARA EKSPRES KILAT, PT", None],
#     "19790": [72760, "daily", "19790", None],
#     "19797": [73145, "daily", "19797", None],
#     "19883": [72864, "daily", "19883", None],
#     "19954": [72136, "daily", "19954", None],
#     "1998": [30325, "daily", "PERFECTA PRATAMA, PT", None],
#     "2008": [30315, "daily", "AMARTHA MIKRO FINTEK, PT (B2B)", None],
#     "2011": [59383, "monthly", "NEW PRAKTIKA ALKESINDO, PT", None],
#     "20126": [72920, "daily", "20126", None],
#     "20129": [72137, "daily", "20129", None],
#     "2016": [30307, "daily", "MILLIONAIRE GROUP INDONESIA, PT", None],
#     "2020": [30303, "daily", "TERA DATA INDONUSA, PT (B2B)", None],
#     "20200": [72138, "daily", "20200", None],
#     "20212": [72978, "daily", "20212", None],
#     "20279": [72784, "daily", "20279", None],
#     "20305": [73111, "daily", "20305", None],
#     "20322": [72142, "daily", "20322", None],
#     "20326": [72742, "daily", "20326", None],
#     "20345": [73183, "daily", "20345", None],
#     "20447": [72902, "daily", "20447", None],
#     "20556": [72632, "daily", "20556", None],
#     "20564": [72146, "daily", "20564", None],
#     "20605": [72962, "daily", "20605", None],
#     "20647": [73134, "daily", "20647", None],
#     "20657": [72726, "daily", "20657", None],
#     "20666": [72150, "daily", "20666", None],
#     "20704": [72151, "daily", "20704", None],
#     "20729": [72152, "daily", "20729", None],
#     "2073": [72917, "daily", "2073", None],
#     "20739": [72886, "daily", "20739", None],
#     "20746": [73113, "daily", "20746", None],
#     "20896": [72155, "daily", "20896", None],
#     "20943": [72156, "daily", "20943", None],
#     "2095": [57416, "monthly", "TOKOPEDIA", 9999],
#     "2104": [30219, "daily", "TANGARA MITRAKOM, PT (B2B)", None],
#     "21057": [72157, "daily", "21057", None],
#     "2109": [59342, "monthly", "HONDA PROSPECT MOTOR, PT (B2B)", None],
#     "21091": [72158, "daily", "21091", None],
#     "21096": [72605, "daily", "21096", None],
#     "21098": [72992, "daily", "21098", None],
#     "21101": [73058, "daily", "21101", None],
#     "21102": [72983, "daily", "21102", None],
#     "21103": [72161, "daily", "21103", None],
#     "21132": [72624, "daily", "21132", None],
#     "2114": [30209, "daily", "WACOAL INDONESIA, PT (B2B)", None],
#     "21187": [72705, "daily", "21187", None],
#     "2119": [57124, "monthly", "CITRA NUSA INSAN CEMERLANG ( E-COMMERCE ) PT", 497],
#     "21204": [72164, "daily", "21204", None],
#     "21205": [73140, "daily", "21205", None],
#     "21250": [72166, "daily", "21250", None],
#     "21269": [72167, "daily", "21269", None],
#     "2127": [73059, "daily", "2127", None],
#     "21276": [72168, "daily", "21276", None],
#     "21291": [72929, "daily", "21291", None],
#     "21360": [72893, "daily", "21360", None],
#     "2137": [30186, "daily", "KK INDONESIA, PT (B2B)", None],
#     "21400": [72874, "daily", "21400", None],
#     "2146": [30177, "daily", "SUMBER CIPTA MULTINIAGA, PT (B2B)", None],
#     "2147": [30176, "daily", "MITRA SUARA SEJATI, PT (B2B)", None],
#     "21526": [73146, "daily", "21526", None],
#     "2156": [73063, "daily", "2156", None],
#     "2157": [30166, "daily", "TEPAT WAKTU LANCAR, PT", None],
#     "2158": [30165, "daily", "ROYAL PILLAR INTERNATIONAL, PT", None],
#     "21646": [72592, "daily", "21646", None],
#     "2169": [56567, "monthly", "PT. EMKA PUTRA PRATAMA (USER TAMBAHAN)", None],
#     "21709": [72174, "daily", "21709", None],
#     "21771": [72175, "daily", "21771", None],
#     "21774": [72593, "daily", "21774", None],
#     "21854": [72177, "daily", "21854", None],
#     "21900": [72867, "daily", "21900", None],
#     "21908": [72676, "daily", "21908", None],
#     "21991": [72180, "daily", "21991", None],
#     "22014": [72181, "daily", "22014", None],
#     "22021": [72657, "daily", "22021", None],
#     "22028": [73004, "daily", "22028", None],
#     "22032": [72183, "daily", "22032", None],
#     "22069": [73175, "daily", "22069", None],
#     "22074": [73210, "daily", "22074", None],
#     "22078": [73194, "daily", "22078", None],
#     "2208": [72709, "daily", "2208", None],
#     "22081": [72184, "daily", "22081", None],
#     "22083": [72185, "daily", "22083", None],
#     "22121": [72648, "daily", "22121", None],
#     "22135": [72187, "daily", "22135", None],
#     "22138": [73219, "daily", "22138", None],
#     "2214": [72849, "daily", "2214", None],
#     "22159": [73068, "daily", "22159", None],
#     "22163": [72189, "daily", "22163", None],
#     "22166": [72551, "daily", "22166", None],
#     "222": [73015, "daily", "222", None],
#     "2221": [30104, "daily", "KARYA BAHARI ABADI, PT (B2B)", None],
#     "22227": [72191, "daily", "22227", None],
#     "22298": [72192, "daily", "22298", None],
#     "22352": [72661, "daily", "22352", None],
#     "22431": [72918, "daily", "22431", None],
#     "22448": [72897, "daily", "22448", None],
#     "22449": [72196, "daily", "22449", None],
#     "22455": [72197, "daily", "22455", None],
#     "22471": [72965, "daily", "22471", None],
#     "22479": [72199, "daily", "22479", None],
#     "22487": [73097, "daily", "22487", None],
#     "22522": [72623, "daily", "22522", None],
#     "2273": [72977, "daily", "2273", None],
#     "22731": [73091, "daily", "22731", None],
#     "22756": [72203, "daily", "22756", None],
#     "22841": [72204, "daily", "22841", None],
#     "22874": [73174, "daily", "22874", None],
#     "22875": [72553, "daily", "22875", None],
#     "2288": [72682, "daily", "2288", None],
#     "22935": [72702, "daily", "22935", None],
#     "22940": [72958, "daily", "22940", None],
#     "22957": [72887, "daily", "22957", None],
#     "22983": [72209, "daily", "22983", None],
#     "23061": [72601, "daily", "23061", None],
#     "2312": [59306, "monthly", "HARMONI MITRA JAYA PT", None],
#     "23168": [72211, "daily", "23168", None],
#     "23274": [72563, "daily", "23274", None],
#     "23304": [72213, "daily", "23304", None],
#     "23313": [73142, "daily", "23313", None],
#     "23316": [72780, "daily", "23316", None],
#     "2333": [72845, "daily", "2333", None],
#     "23382": [72215, "daily", "23382", None],
#     "23416": [72790, "daily", "23416", None],
#     "23422": [72217, "daily", "23422", None],
#     "2351": [29974, "daily", "IKEA", None],
#     "23569": [72218, "daily", "23569", None],
#     "23579": [72219, "daily", "23579", None],
#     "2358": [72628, "daily", "2358", None],
#     "23612": [72220, "daily", "23612", None],
#     "23614": [72821, "daily", "23614", None],
#     "23638": [72222, "daily", "23638", None],
#     "23650": [72829, "daily", "23650", None],
#     "23657": [72224, "daily", "23657", None],
#     "23671": [72768, "daily", "23671", None],
#     "237": [72708, "daily", "237", None],
#     "2372": [59268, "monthly", "DARMAWISATA INDONESIA PT", 497],
#     "23793": [72226, "daily", "23793", None],
#     "2381": [59281, "monthly", "ROYAL MEDICALINK PHARMALAB PT", 497],
#     "23846": [72227, "daily", "23846", None],
#     "23903": [72693, "daily", "23903", None],
#     "2394": [29931, "monthly", "SWIFT SHIPMENT SOLUTIONS, PT (B2B)", None],
#     "23944": [72830, "daily", "23944", None],
#     "2399": [29926, "daily", "SINAR ELOK ABADI, PT (ARC)", None],
#     "24023": [72230, "daily", "24023", None],
#     "24084": [72575, "daily", "24084", None],
#     "24101": [72232, "daily", "24101", None],
#     "2411": [29914, "daily", "BIMASAKTI MULTI SINERGI, PT", None],
#     "24112": [72761, "daily", "24112", None],
#     "24139": [72753, "daily", "24139", None],
#     "24143": [72235, "daily", "24143", None],
#     "24178": [72722, "daily", "24178", None],
#     "24229": [72237, "daily", "24229", None],
#     "2423": [72639, "daily", "2423", None],
#     "24242": [72238, "daily", "24242", None],
#     "24252": [73185, "daily", "24252", None],
#     "24281": [72896, "daily", "24281", None],
#     "24282": [73112, "daily", "24282", None],
#     "24283": [72241, "daily", "24283", None],
#     "24296": [72604, "daily", "24296", None],
#     "24307": [72243, "daily", "24307", None],
#     "24357": [72941, "daily", "24357", None],
#     "24411": [73108, "daily", "24411", None],
#     "24413": [72673, "daily", "24413", None],
#     "24415": [72788, "daily", "24415", None],
#     "24421": [72981, "daily", "24421", None],
#     "24422": [73156, "daily", "24422", None],
#     "24453": [72249, "daily", "24453", None],
#     "24455": [72721, "daily", "24455", None],
#     "24457": [72251, "daily", "24457", None],
#     "2446": [59264, "weekly", "DUTA FIRZA PT", 497],
#     "24474": [72252, "daily", "24474", None],
#     "24538": [72253, "daily", "24538", None],
#     "2457": [59286, "monthly", "BANK SINARMAS PT", None],
#     "2459": [29866, "daily", "ZALORA", None],
#     "24655": [72255, "daily", "24655", None],
#     "24656": [72256, "daily", "24656", None],
#     "24657": [72257, "daily", "24657", None],
#     "24658": [72566, "daily", "24658", None],
#     "24681": [73034, "daily", "24681", None],
#     "24712": [72260, "daily", "24712", None],
#     "24730": [72261, "daily", "24730", None],
#     "24739": [72262, "daily", "24739", None],
#     "24807": [72263, "daily", "24807", None],
#     "24870": [73115, "daily", "24870", None],
#     "25013": [72848, "daily", "25013", None],
#     "25014": [72266, "daily", "25014", None],
#     "25046": [73032, "daily", "25046", None],
#     "25049": [73014, "daily", "25049", None],
#     "25054": [73169, "daily", "25054", None],
#     "25055": [72269, "daily", "25055", None],
#     "25087": [72271, "daily", "25087", None],
#     "25099": [73013, "daily", "25099", None],
#     "25101": [72273, "daily", "25101", None],
#     "25133": [73098, "daily", "25133", None],
#     "25144": [72275, "daily", "25144", None],
#     "25147": [72276, "daily", "25147", None],
#     "25148": [72277, "daily", "25148", None],
#     "25171": [73141, "daily", "25171", None],
#     "25210": [72280, "daily", "25210", None],
#     "25224": [72910, "daily", "25224", None],
#     "25252": [73188, "daily", "25252", None],
#     "25264": [73212, "daily", "25264", None],
#     "25273": [72282, "daily", "25273", None],
#     "25323": [73193, "daily", "25323", None],
#     "25330": [72283, "daily", "25330", None],
#     "25331": [72284, "daily", "25331", None],
#     "25509": [73081, "daily", "25509", None],
#     "25528": [72286, "daily", "25528", None],
#     "25557": [72287, "daily", "25557", None],
#     "25561": [72987, "daily", "25561", None],
#     "25571": [73179, "daily", "25571", None],
#     "25634": [72899, "daily", "25634", None],
#     "25639": [73090, "daily", "25639", None],
#     "25655": [72610, "daily", "25655", None],
#     "25665": [72770, "daily", "25665", None],
#     "25686": [73129, "daily", "25686", None],
#     "25719": [72293, "daily", "25719", None],
#     "25728": [72882, "daily", "25728", None],
#     "25746": [72295, "daily", "25746", None],
#     "25761": [72831, "daily", "25761", None],
#     "25778": [73037, "daily", "25778", None],
#     "25779": [72297, "daily", "25779", None],
#     "25887": [72298, "daily", "25887", None],
#     "25923": [72299, "daily", "25923", None],
#     "26066": [72741, "daily", "26066", None],
#     "26086": [72301, "daily", "26086", None],
#     "26122": [73089, "daily", "26122", None],
#     "26123": [72303, "daily", "26123", None],
#     "26124": [72304, "daily", "26124", None],
#     "26145": [73203, "daily", "26145", None],
#     "26146": [72979, "daily", "26146", None],
#     "26209": [72306, "daily", "26209", None],
#     "26232": [72307, "daily", "26232", None],
#     "26278": [72308, "daily", "26278", None],
#     "26279": [72796, "daily", "26279", None],
#     "26280": [72310, "daily", "26280", None],
#     "26341": [72895, "daily", "26341", None],
#     "26342": [72866, "daily", "26342", None],
#     "26355": [72839, "daily", "26355", None],
#     "26432": [72951, "daily", "26432", None],
#     "26439": [73182, "daily", "26439", None],
#     "26560": [72689, "daily", "26560", None],
#     "26561": [73181, "daily", "26561", None],
#     "26568": [73151, "daily", "26568", None],
#     "26571": [72316, "daily", "26571", None],
#     "26590": [72664, "daily", "26590", None],
#     "26593": [73207, "daily", "26593", None],
#     "26595": [73076, "daily", "26595", None],
#     "26621": [72319, "daily", "26621", None],
#     "26622": [72320, "daily", "26622", None],
#     "26639": [72321, "daily", "26639", None],
#     "26641": [72322, "daily", "26641", None],
#     "26671": [73033, "daily", "26671", None],
#     "26691": [73186, "daily", "26691", None],
#     "26718": [72840, "daily", "26718", None],
#     "26772": [72326, "daily", "26772", None],
#     "26776": [72809, "daily", "26776", None],
#     "26792": [72328, "daily", "26792", None],
#     "26812": [73189, "daily", "26812", None],
#     "26845": [72751, "daily", "26845", None],
#     "26848": [73216, "daily", "26848", None],
#     "26889": [72330, "daily", "26889", None],
#     "26890": [72921, "daily", "26890", None],
#     "27167": [72332, "daily", "27167", None],
#     "27208": [72333, "daily", "27208", None],
#     "27225": [72922, "daily", "27225", None],
#     "27229": [72335, "daily", "27229", None],
#     "27234": [72674, "daily", "27234", None],
#     "27238": [72337, "daily", "27238", None],
#     "27240": [72338, "daily", "27240", None],
#     "27243": [72576, "daily", "27243", None],
#     "27266": [72340, "daily", "27266", None],
#     "27269": [72341, "daily", "27269", None],
#     "27281": [72342, "daily", "27281", None],
#     "27288": [73088, "daily", "27288", None],
#     "27348": [72345, "daily", "27348", None],
#     "27352": [73201, "daily", "27352", None],
#     "27359": [72791, "daily", "27359", None],
#     "27375": [72582, "daily", "27375", None],
#     "27384": [72348, "daily", "27384", None],
#     "27386": [73208, "daily", "27386", None],
#     "27443": [72968, "daily", "27443", None],
#     "27460": [72350, "daily", "27460", None],
#     "27462": [73195, "daily", "27462", None],
#     "27502": [72351, "daily", "27502", None],
#     "27503": [72352, "daily", "27503", None],
#     "27530": [72353, "daily", "27530", None],
#     "27564": [73171, "daily", "27564", None],
#     "27566": [72697, "daily", "27566", None],
#     "27602": [72948, "daily", "27602", None],
#     "27624": [72356, "daily", "27624", None],
#     "27659": [72357, "daily", "27659", None],
#     "27721": [72931, "daily", "27721", None],
#     "27730": [73184, "daily", "27730", None],
#     "27743": [73170, "daily", "27743", None],
#     "27744": [72359, "daily", "27744", None],
#     "27749": [72360, "daily", "27749", None],
#     "27760": [72914, "daily", "27760", None],
#     "27786": [73056, "daily", "27786", None],
#     "27798": [72908, "daily", "27798", None],
#     "27815": [73200, "daily", "27815", None],
#     "27835": [72364, "daily", "27835", None],
#     "27855": [72365, "daily", "27855", None],
#     "27891": [73120, "daily", "27891", None],
#     "27900": [73155, "daily", "27900", None],
#     "27903": [72585, "daily", "27903", None],
#     "27909": [72369, "daily", "27909", None],
#     "27910": [72759, "daily", "27910", None],
#     "27929": [72807, "daily", "27929", None],
#     "27964": [73218, "daily", "27964", None],
#     "27974": [72743, "daily", "27974", None],
#     "27977": [72372, "daily", "27977", None],
#     "28033": [72373, "daily", "28033", None],
#     "28055": [73135, "daily", "28055", None],
#     "28064": [72653, "daily", "28064", None],
#     "28066": [73211, "daily", "28066", None],
#     "28109": [72376, "daily", "28109", None],
#     "28119": [72377, "daily", "28119", None],
#     "28134": [72378, "daily", "28134", None],
#     "28137": [72569, "daily", "28137", None],
#     "28178": [72380, "daily", "28178", None],
#     "28207": [73065, "daily", "28207", None],
#     "28214": [72670, "daily", "28214", None],
#     "28248": [73125, "daily", "28248", None],
#     "28254": [72892, "daily", "28254", None],
#     "28269": [72692, "daily", "28269", None],
#     "28370": [72620, "daily", "28370", None],
#     "28395": [72766, "daily", "28395", None],
#     "28400": [72736, "daily", "28400", None],
#     "28401": [72883, "daily", "28401", None],
#     "28420": [72885, "daily", "28420", None],
#     "28437": [72691, "daily", "28437", None],
#     "28443": [72391, "daily", "28443", None],
#     "28456": [73001, "daily", "28456", None],
#     "28459": [72937, "daily", "28459", None],
#     "28522": [72716, "daily", "28522", None],
#     "28543": [72842, "daily", "28543", None],
#     "28569": [73040, "daily", "28569", None],
#     "28581": [72396, "daily", "28581", None],
#     "28583": [72879, "daily", "28583", None],
#     "28642": [73190, "daily", "28642", None],
#     "28644": [73209, "daily", "28644", None],
#     "28647": [72399, "daily", "28647", None],
#     "28650": [72400, "daily", "28650", None],
#     "28670": [72401, "daily", "28670", None],
#     "28678": [73079, "daily", "28678", None],
#     "28679": [72403, "daily", "28679", None],
#     "28691": [72404, "daily", "28691", None],
#     "28696": [72405, "daily", "28696", None],
#     "28725": [73029, "daily", "28725", None],
#     "28737": [73214, "daily", "28737", None],
#     "28740": [72407, "daily", "28740", None],
#     "28742": [72554, "daily", "28742", None],
#     "28799": [72409, "daily", "28799", None],
#     "28822": [72727, "daily", "28822", None],
#     "28857": [72411, "daily", "28857", None],
#     "28859": [72412, "daily", "28859", None],
#     "28861": [73197, "daily", "28861", None],
#     "28862": [73205, "daily", "28862", None],
#     "28869": [72413, "daily", "28869", None],
#     "28870": [72844, "daily", "28870", None],
#     "28873": [73217, "daily", "28873", None],
#     "28881": [72949, "daily", "28881", None],
#     "28885": [72666, "daily", "28885", None],
#     "28887": [72748, "daily", "28887", None],
#     "28987": [72419, "daily", "28987", None],
#     "29024": [72579, "daily", "29024", None],
#     "29029": [73173, "daily", "29029", None],
#     "29036": [73202, "daily", "29036", None],
#     "29039": [72421, "daily", "29039", None],
#     "29040": [72678, "daily", "29040", None],
#     "29044": [72792, "daily", "29044", None],
#     "29080": [72424, "daily", "29080", None],
#     "29105": [73121, "daily", "29105", None],
#     "29122": [72426, "daily", "29122", None],
#     "29123": [72667, "daily", "29123", None],
#     "29125": [72778, "daily", "29125", None],
#     "29128": [72718, "daily", "29128", None],
#     "29136": [72429, "daily", "29136", None],
#     "29165": [73128, "daily", "29165", None],
#     "29179": [72828, "daily", "29179", None],
#     "29200": [73039, "daily", "29200", None],
#     "29209": [72967, "daily", "29209", None],
#     "29227": [72434, "daily", "29227", None],
#     "29233": [73114, "daily", "29233", None],
#     "29236": [72435, "daily", "29236", None],
#     "29246": [73075, "daily", "29246", None],
#     "29248": [72772, "daily", "29248", None],
#     "29284": [73069, "daily", "29284", None],
#     "29291": [72439, "daily", "29291", None],
#     "29296": [72440, "daily", "29296", None],
#     "29303": [72441, "daily", "29303", None],
#     "29334": [72617, "daily", "29334", None],
#     "29338": [72443, "daily", "29338", None],
#     "29339": [72444, "daily", "29339", None],
#     "29366": [72445, "daily", "29366", None],
#     "29370": [72446, "daily", "29370", None],
#     "29372": [72447, "daily", "29372", None],
#     "29403": [72656, "daily", "29403", None],
#     "29417": [72449, "daily", "29417", None],
#     "29418": [72942, "daily", "29418", None],
#     "29419": [72695, "daily", "29419", None],
#     "29428": [73213, "daily", "29428", None],
#     "29431": [72804, "daily", "29431", None],
#     "29443": [73118, "daily", "29443", None],
#     "29444": [72590, "daily", "29444", None],
#     "29464": [72737, "daily", "29464", None],
#     "29471": [72954, "daily", "29471", None],
#     "29483": [72457, "daily", "29483", None],
#     "29491": [73003, "daily", "29491", None],
#     "29494": [72459, "daily", "29494", None],
#     "29517": [72460, "daily", "29517", None],
#     "29521": [72668, "daily", "29521", None],
#     "29544": [72462, "daily", "29544", None],
#     "29585": [73106, "daily", "29585", None],
#     "29586": [73070, "daily", "29586", None],
#     "29587": [72465, "daily", "29587", None],
#     "29593": [72466, "daily", "29593", None],
#     "29630": [72467, "daily", "29630", None],
#     "29631": [72621, "daily", "29631", None],
#     "29636": [73192, "daily", "29636", None],
#     "29637": [72468, "daily", "29637", None],
#     "29639": [73086, "daily", "29639", None],
#     "29649": [72470, "daily", "29649", None],
#     "29669": [72471, "daily", "29669", None],
#     "29706": [72472, "daily", "29706", None],
#     "29707": [72473, "daily", "29707", None],
#     "29726": [72474, "daily", "29726", None],
#     "29731": [72475, "daily", "29731", None],
#     "29738": [72476, "daily", "29738", None],
#     "29741": [72477, "daily", "29741", None],
#     "29749": [72596, "daily", "29749", None],
#     "29763": [72479, "daily", "29763", None],
#     "29766": [72480, "daily", "29766", None],
#     "29771": [72699, "daily", "29771", None],
#     "29780": [72773, "daily", "29780", None],
#     "29786": [73143, "daily", "29786", None],
#     "29789": [73126, "daily", "29789", None],
#     "29792": [73206, "daily", "29792", None],
#     "29793": [73198, "daily", "29793", None],
#     "29795": [72484, "daily", "29795", None],
#     "29804": [72485, "daily", "29804", None],
#     "29816": [72486, "daily", "29816", None],
#     "29839": [72811, "daily", "29839", None],
#     "29853": [72487, "daily", "29853", None],
#     "29871": [72488, "daily", "29871", None],
#     "29872": [72822, "daily", "29872", None],
#     "29876": [72679, "daily", "29876", None],
#     "29903": [72998, "daily", "29903", None],
#     "29904": [72717, "daily", "29904", None],
#     "29938": [72494, "daily", "29938", None],
#     "29940": [72495, "daily", "29940", None],
#     "29943": [72847, "daily", "29943", None],
#     "29944": [72641, "daily", "29944", None],
#     "29952": [73066, "daily", "29952", None],
#     "29964": [73172, "daily", "29964", None],
#     "29969": [73178, "daily", "29969", None],
#     "29972": [73177, "daily", "29972", None],
#     "29978": [73131, "daily", "29978", None],
#     "29988": [73199, "daily", "29988", None],
#     "30014": [72654, "daily", "30014", None],
#     "30026": [73180, "daily", "30026", None],
#     "30028": [72501, "daily", "30028", None],
#     "30046": [72502, "daily", "30046", None],
#     "30048": [72618, "daily", "30048", None],
#     "30053": [72505, "daily", "30053", None],
#     "30059": [72933, "daily", "30059", None],
#     "30093": [72652, "daily", "30093", None],
#     "30111": [73204, "daily", "30111", None],
#     "30119": [72508, "daily", "30119", None],
#     "30120": [72509, "daily", "30120", None],
#     "30121": [72510, "daily", "30121", None],
#     "30130": [72815, "daily", "30130", None],
#     "30147": [73176, "daily", "30147", None],
#     "30157": [72512, "daily", "30157", None],
#     "30159": [72513, "daily", "30159", None],
#     "30162": [73196, "daily", "30162", None],
#     "30163": [72889, "daily", "30163", None],
#     "30164": [73168, "daily", "30164", None],
#     "30165": [73133, "daily", "30165", None],
#     "30166": [73220, "daily", "30166", None],
#     "30173": [72517, "daily", "30173", None],
#     "30184": [72518, "daily", "30184", None],
#     "30189": [72519, "daily", "30189", None],
#     "30212": [72913, "daily", "30212", None],
#     "30219": [72522, "daily", "30219", None],
#     "30231": [72523, "daily", "30231", None],
#     "30232": [72567, "daily", "30232", None],
#     "30233": [72525, "daily", "30233", None],
#     "30234": [73167, "daily", "30234", None],
#     "30235": [72785, "daily", "30235", None],
#     "30247": [72528, "daily", "30247", None],
#     "30255": [72529, "daily", "30255", None],
#     "30270": [72530, "daily", "30270", None],
#     "30272": [72531, "daily", "30272", None],
#     "30287": [72532, "daily", "30287", None],
#     "30291": [72533, "daily", "30291", None],
#     "30301": [73215, "daily", "30301", None],
#     "30306": [73084, "daily", "30306", None],
#     "30317": [73161, "daily", "30317", None],
#     "30341": [72690, "daily", "30341", None],
#     "30344": [72537, "daily", "30344", None],
#     "30357": [72539, "daily", "30357", None],
#     "30363": [73187, "daily", "30363", None],
#     "30369": [72540, "daily", "30369", None],
#     "30385": [72919, "daily", "30385", None],
#     "30388": [73023, "daily", "30388", None],
#     "30391": [72544, "daily", "30391", None],
#     "30396": [73191, "daily", "30396", None],
#     "30404": [73157, "daily", "30404", None],
#     "30410": [72545, "daily", "30410", None],
#     "316": [58437, "weekly", "PT. MEDIA TELEVISI INDONESIA ( METRO TV )", None],
#     "359": [60079, "monthly", "PT. CITRA MELATI SELARAS ", None],
#     "376": [31955, "daily", "WAHANA PRESTASI LOGISTIK, PT (B2C)", None],
#     "381": [31946, "daily", "WAHANA PRESTASI LOGISTIK, PT (B2B)", None],
#     "395": [31935, "daily", "MULTIMARILIN PERMATA NUSANTARA, PT (B2B)", None],
#     "434": [56995, "weekly", "Karaniya Books", None],
#     "445": [57786, "monthly", "PT. WAHANA AYU PRIMADONA", None],
#     "467": [54627, "monthly", "PT. ELANG BUANA PERKASA ", None],
#     "47": [72745, "daily", "47", None],
#     "481": [31842, "daily", "(NONACTIVE) DESTINASI MARITIM INDONESIA, PT (B2B)", None],
#     "528": [31759, "daily", "NUSA PRIMA EXPRESS, PT (B2B)", None],
#     "55": [58115, "monthly", "PT. SURYA PERTIWI B2C", None],
#     "569": [31755, "daily", "INDAH JAYA EXPRESS, PT (B2B)", None],
#     "583": [72801, "daily", "583", None],
#     "657": [57051, "monthly", "PT. OSCAR MAS", None],
#     "683": [31633, "daily", "DITEK JAYA, PT (B2B)", None],
#     "71": [72961, "daily", "71", None],
#     "735": [31591, "daily", "(NONACTIVE) PANCARAN SAMUDERA SHIPYARD, PT (B2C)", None],
#     "754": [31570, "daily", "NEW IMAGE HEALTH SCIENCES, PT (B2C)", None],
#     "769": [58712, "monthly", "PT. IMPACT POWER MANDIRI", None],
#     "772": [31488, "daily", "SOCIOLLA RITEL INDONESIA, PT (B2C)", None],
#     "776": [31546, "daily", "ERHA CLINIC INDONESIA, PT (B2C)", None],
#     "777": [31545, "daily", "ERHA MEDICALS, PT (B2C)", None],
#     "779": [62023, "monthly", "PT. ADITYA SENTANA AGRO", None],
#     "799": [31481, "daily", "UNITED HYDRAULIC TECHNOLOGY, PT (B2B)", None],
#     "841": [31489, "daily", "GALOEH HUSADA FARMA, PT (VAKSIN) (B2B)", None],
#     "854": [56637, "monthly", "PT KAMI IDEA INDONESIA", None],
#     "859": [31463, "daily", "TATONAS, CV (B2C)", None],
#     "870": [72876, "daily", "870", None],
#     "903": [31395, "daily", "MEGA PERINTIS TBK, PT (B2C)", None],
#     "925": [56734, "monthly", "CV ALIA KREASI MANDIRI", None],
#     "926": [55070, "monthly", "PT BENANG JARUM INDONESIA", None],
#     "929": [31382, "daily", "BUMEN REDJA ABADI, PT (B2B)", None],
#     "941": [72863, "daily", "941", None],
#     "943": [31372, "daily", "YOMARI EKSIS SERENTAK, PT (B2C)", None],
#     "952": [54394, "weekly", "PT EIG DERMAL WELLNESS INDONESIA", None],
#     "959": [72633, "daily", "959", None],
# }

rp_dict = {
    "24457": [72251, "daily", "24457", None],
    "29517": [72460, "daily", "29517", None],
    "2095": [57416, "monthly", "TOKOPEDIA", 9999],
    "2095w": [57416, "weekly", "TOKOPEDIA", 9998],
    "2095bw": [57416, "biweekly", "TOKOPEDIA", 9997],
}

res = [
    # daily
    (
        "5231232199LP1718858850682",
        "20240627T203625_5231232199LP1718858850682",
        "2024-06-20 04:47:30",
        "2024-07-26 12:25:20",
        "24457",
        "C",
    ),
    (
        "5231232188LP1718702647357",
        "20240627T204534_5231232188LP1718702647357",
        "2024-06-18 09:24:06",
        "2024-06-26 12:25:20",
        "29517",
        "C",
    ),
    (
        "5231232188LP1718702647357",
        "20240627T204534_5231232188LP1718702647357",
        "2024-06-18 09:24:06",
        "2024-07-07 12:25:20",
        "29517",
        "C",
    ),
    (
        "5231232188LP1718702647357",
        "20240627T204534_5231232188LP1718702647357",
        "2024-06-18 09:24:06",
        "2024-07-08 12:25:20",
        "29517",
        "C",
    ),
    # weekly
    (
        "HAHA001_88LP1717813193066",
        "20240628T023814_HAHA001_88LP1717813193066",
        "2024-06-08 02:19:52",
        "2024-06-26 19:28:54",
        "2095w",
        "E",
    ),
    (
        "HAHA001_88LP1718945279132",
        "20240628T023814_HAHA001_88LP1718945279132",
        "2024-06-21 04:47:58",
        "2024-06-28 19:28:54",
        "2095w",
        "E",
    ),
    (
        "HAHA001_88LP1718780342874",
        "20240628T023814_HAHA001_88LP1718780342874",
        "2024-06-19 06:59:02",
        "2024-06-30 19:28:54",
        "2095w",
        "E",
    ),
    (
        "HAHA001_88LP1718707858904",
        "20240628T023814_HAHA001_88LP1718707858904",
        "2024-06-18 10:50:58",
        "2024-07-01 19:28:54",
        "2095w",
        "E",
    ),
    (
        "HAHA001_88LP1718875188256",
        "20240628T023814_HAHA001_88LP1718875188256",
        "2024-06-20 09:19:47",
        "2024-07-20 19:28:54",
        "2095w",
        "E",
    ),
    (
        "HAHA001_88LP1718875188256",
        "20240628T023814_HAHA001_88LP1718875188256",
        "2024-06-20 09:19:47",
        "2024-07-07 19:28:54",
        "2095w",
        "E",
    ),
    (
        "HAHA001_88LP1718875188256",
        "20240628T023814_HAHA001_88LP1718875188256",
        "2024-06-20 09:19:47",
        "2024-07-08 19:28:54",
        "2095w",
        "E",
    ),
    (
        "HAHA001_88LP1718875188256",
        "20240628T023814_HAHA001_88LP1718875188256",
        "2024-06-20 09:19:47",
        "2024-07-09 19:28:54",
        "2095w",
        "E",
    ),
    (
        "HAHA001_88LP1718875188256",
        "20240628T023814_HAHA001_88LP1718875188256",
        "2024-06-20 09:19:47",
        "2024-07-23 19:28:54",
        "2095w",
        "E",
    ),
    (
        "HAHA001_88LP1718875188256",
        "20240628T023814_HAHA001_88LP1718875188256",
        "2024-06-20 09:19:47",
        "2024-07-30 19:28:54",
        "2095w",
        "E",
    ),
    # biweekly
    (
        "HAHA001_88LP1717813193066",
        "20240628T023814_HAHA001_88LP1717813193066",
        "2024-06-08 02:19:52",
        "2024-06-04 19:28:54",
        "2095bw",
        "E",
    ),
    (
        "HAHA001_88LP1718945279132",
        "20240628T023814_HAHA001_88LP1718945279132",
        "2024-06-21 04:47:58",
        "2024-06-05 19:28:54",
        "2095bw",
        "E",
    ),
    (
        "HAHA001_88LP1718780342874",
        "20240628T023814_HAHA001_88LP1718780342874",
        "2024-06-19 06:59:02",
        "2024-06-30 19:28:54",
        "2095bw",
        "E",
    ),
    (
        "HAHA001_88LP1718707858904",
        "20240628T023814_HAHA001_88LP1718707858904",
        "2024-06-18 10:50:58",
        "2024-07-01 19:28:54",
        "2095bw",
        "E",
    ),
    (
        "HAHA001_88LP1718875188256",
        "20240628T023814_HAHA001_88LP1718875188256",
        "2024-06-20 09:19:47",
        "2024-07-15 19:28:54",
        "2095bw",
        "E",
    ),
    (
        "HAHA001_88LP1718875188256",
        "20240628T023814_HAHA001_88LP1718875188256",
        "2024-06-20 09:19:47",
        "2024-07-20 19:28:54",
        "2095bw",
        "E",
    ),
    # monthly
    (
        "HAHA001_88LP1718693166911",
        "20240628T023814_HAHA001_88LP1718693166911",
        "2024-06-18 06:46:06",
        "2024-06-29 19:28:54",
        "2095",
        "E",
    ),
    (
        "HAHA001_88LP1718693166911",
        "20240628T023814_HAHA001_88LP1718693166911",
        "2024-06-18 06:46:06",
        "2024-07-04 23:59:59",
        "2095",
        "E",
    ),
    (
        "HAHA001_88LP1718693166911",
        "20240628T023814_HAHA001_88LP1718693166911",
        "2024-06-18 06:46:06",
        "2024-07-05 00:00:00",
        "2095",
        "E",
    ),
    (
        "HAHA001_88LP1718693166911",
        "20240628T023814_HAHA001_88LP1718693166911",
        "2024-06-18 06:46:06",
        "2024-07-05 00:00:01",
        "2095",
        "E",
    ),
    (
        "HAHA001_88LP1718861836868",
        "20240628T023814_HAHA001_88LP1718861836868",
        "2024-06-20 05:37:15",
        "2024-07-04 19:28:54",
        "2095",
        "E",
    ),
    (
        "HAHA001_88LP1718941642339",
        "20240628T023814_HAHA001_88LP1718941642339",
        "2024-06-21 03:47:21",
        "2024-07-05 19:28:54",
        "2095",
        "E",
    ),
    (
        "HAHA001_88LP1718438079817",
        "20240628T023814_HAHA001_88LP1718438079817",
        "2024-06-15 07:54:39",
        "2024-07-10 19:28:54",
        "2095",
        "E",
    ),
    (
        "HAHA001_88LP1718008770767",
        "20240628T023814_HAHA001_88LP1718008770767",
        "2024-06-10 08:39:29",
        "2024-07-26 19:28:54",
        "2095",
        "E",
    ),
    (
        "HAHA001_88LP1718008770767",
        "20240628T023814_HAHA001_88LP1718008770767",
        "2024-07-01 02:47:07",
        "2024-07-01 09:25:27",
        "2095",
        "E",
    ),
    (
        "HAHA001_88LP1718008770767",
        "20240628T023814_HAHA001_88LP1718008770767",
        "2024-07-01 02:47:07",
        "2024-07-05 00:00:02",
        "2095",
        "E",
    ),
    (
        "HAHA001_88LP1718008770767",
        "20240628T023814_HAHA001_88LP1718008770767",
        "2024-07-01 02:47:07",
        "2024-08-05 00:00:00",
        "2095",
        "E",
    ),
]

SCHEDULE_DAILY_HOUR = 2
SCHEDULE_DAILY_MINUTE = 30  # 02:30 AM
SCHEDULE_WEEKLY_DAY = 0  # 0 -> Monday, 6 -> Sunday
SCHEDULE_BIWEEKLY_FIRST_DATE = 5  # 5th of the month
SCHEDULE_BIWEEKLY_SECOND_DATE = 20  # 20th of the month
SCHEDULE_MONTHLY = 5  # 5th of the next month

pf_query = _lib.update_proforma_schedule_list(
    res,
    rp_dict,
    SCHEDULE_DAILY_HOUR,
    SCHEDULE_DAILY_MINUTE,
    SCHEDULE_WEEKLY_DAY,
    SCHEDULE_BIWEEKLY_FIRST_DATE,
    SCHEDULE_BIWEEKLY_SECOND_DATE,
    SCHEDULE_MONTHLY,
)
print(pf_query)
# print("len of lock: ", len(pf_query))
